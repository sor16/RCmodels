<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Generalized Power Law Model with Constant Variance — gplm0 • bdrc</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Generalized Power Law Model with Constant Variance — gplm0" />
<meta property="og:description" content="gplm0 is used to fit a discharge rating curve for paired measurements of stage and discharge using a Generalized Power Law Model with constant variance as described in Hrafnkelsson et al. See &quot;Details&quot; for a more elaborate description of the model." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bdrc</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/tournament.html">Tournament - Model comparison</a>
    </li>
    <li>
      <a href="../articles/advanced_visualization.html">Advanced visualization</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sor16/bdrc/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generalized Power Law Model with Constant Variance</h1>
    <small class="dont-index">Source: <a href='https://github.com/sor16/bdrc/blob/master/R/gplm0.R'><code>R/gplm0.R</code></a></small>
    <div class="hidden name"><code>gplm0.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>gplm0 is used to fit a discharge rating curve for paired measurements of stage and discharge using a Generalized Power Law Model with constant variance as described in Hrafnkelsson et al. See "Details" for a more elaborate description of the model.</p>
    </div>

    <pre class="usage"><span class='fu'>gplm0</span><span class='op'>(</span>
  <span class='va'>formula</span>,
  <span class='va'>data</span>,
  c_param <span class='op'>=</span> <span class='cn'>NULL</span>,
  h_max <span class='op'>=</span> <span class='cn'>NULL</span>,
  parallel <span class='op'>=</span> <span class='cn'>T</span>,
  forcepoint <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>FALSE</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>an object of class "formula", with discharge column name as response and stage column name as a covariate, i.e. of the form y~x where y is discharge in \(m^3/s\) and x is stage in \(m\) (it is very important that the data is in the correct units).</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>data.frame containing the variables specified in formula.</p></td>
    </tr>
    <tr>
      <th>c_param</th>
      <td><p>stage for which there is zero discharge. If NULL, it is treated as unknown in the model and inferred from the data.</p></td>
    </tr>
    <tr>
      <th>h_max</th>
      <td><p>maximum stage to which the rating curve should extrapolate to. If NULL, the maximum stage value in data is selected as an upper bound.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>logical value indicating whether to run the MCMC in parallel or not. Defaults to TRUE.</p></td>
    </tr>
    <tr>
      <th>forcepoint</th>
      <td><p>logical vector of the same length as the number of rows in data. If an element at index i is TRUE it indicates that the rating curve should be forced through the i-th measurement. Use with care, as this will strongly influence the resulting rating curve.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>gplm0 returns an object of class "gplm0". An object of class "gplm0" is a list containing the following components: <br /></p>
<dt><code>rating_curve</code></dt><dd><p>a data frame with 2.5%, 50% and 97.5% quantiles of the posterior distribution of the rating curve.</p></dd>
<dt><code>rating_curve_mean</code></dt><dd><p>a data frame with 2.5%, 50% and 97.5% quantiles of the posterior distribution of the mean of the rating curve.</p></dd>
<dt><code>param_summary</code></dt><dd><p>a data frame with 2.5%, 50% and 97.5% quantiles of the posterior distribution of latent- and hyperparameters.</p></dd>
<dt><code>beta_summary</code></dt><dd><p>a data frame with 2.5%, 50% and 97.5% quantiles of the posterior distribution of \(\beta\).</p></dd>
<dt><code>Deviance_summary</code></dt><dd><p>a data frame with 2.5%, 50% and 97.5% quantiles of the posterior distribution of the deviance.</p></dd>
<dt><code>rating_curve_posterior</code></dt><dd><p>a matrix containing the full thinned posterior samples of the posterior distribution of the rating curve (excluding burn-in).</p></dd>
<dt><code>rating_curve_mean_posterior</code></dt><dd><p>a matrix containing the full thinned posterior samples of the posterior distribution of the mean of the rating curve (excluding burn-in).</p></dd>
<dt><code>a_posterior</code></dt><dd><p>a numeric vector containing the full thinned posterior samples of the posterior distribution of \(a\).</p></dd>
<dt><code>b_posterior</code></dt><dd><p>a numeric vector containing the full thinned posterior samples of the posterior distribution of \(b\).</p></dd>
<dt><code>c_posterior</code></dt><dd><p>a numeric vector containing the full thinned posterior samples of the posterior distribution of \(c\).</p></dd>
<dt><code>sigma_eps_posterior</code></dt><dd><p>a numeric vector containing the full thinned posterior samples of the posterior distribution of \(\sigma_{\epsilon}\).</p></dd>
<dt><code>sigma_beta_posterior</code></dt><dd><p>a numeric vector containing the full thinned posterior samples of the posterior distribution of \(\sigma_{\beta}\).</p></dd>
<dt><code>phi_beta_posterior</code></dt><dd><p>a numeric vector containing the full thinned posterior samples of the posterior distribution of \(\phi_{\beta}\).</p></dd>
<dt><code>sigma_eta_posterior</code></dt><dd><p>a numeric vector containing the full thinned posterior samples of the posterior distribution of \(\sigma_{\eta}\).</p></dd>
<dt><code>beta_posterior</code></dt><dd><p>a numeric vector containing the full thinned posterior samples of the posterior distribution of \(\beta\).</p></dd>
<dt><code>Deviance_posterior</code></dt><dd><p>a numeric vector containing the full thinned posterior samples of the posterior distribution of the deviance excluding burnin samples.</p></dd>
<dt><code>D_hat</code></dt><dd><p>deviance at the median value of the parameters</p></dd>
<dt><code>num_effective_param</code></dt><dd><p>number of effective parameters, which is calculated as median(Deviance_posterior) - D_hat</p></dd>
<dt><code>DIC</code></dt><dd><p>Deviance Information Criterion for the model, calculated as D_hat + 2*num_effective_parameters</p></dd>
<dt><code>acceptance_rate</code></dt><dd><p>proportion of accepted samples in the thinned MCMC chain (excluding burn-in).</p></dd>
<dt><code>formula</code></dt><dd><p>object of type "formula" provided by the user.</p></dd>
<dt><code>data</code></dt><dd><p>data provided by the user.</p></dd>
<dt><code>run_info</code></dt><dd><p>Information about the specific parameters used in the MCMC chain.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The generalized power-law model is of the form
$$Q=a(h-c)^{f(h)}$$
where \(Q\) is discharge, \(h\) is stage, \(a\) and \(c\) are unknown constants and \(f\) is a function of  \(h\) referred to as the generalized power-law exponent.<br /><br />
The Bayesian generalized power-law model is presented as a Bayesian hierarchical model. The function \(f\) is modelled at the latent level as a fixed constant b plus a continuous stochastic process which is assumed to be twice differentiable. The model is on a logarithmic scale
$$log(Q_i) = log(a) + (b + \beta(h_i)) log(h_i - c) + \epsilon,     i = 1,...,n$$
where \(\epsilon\) follows a normal distribution with mean zero and variance \(\sigma_\epsilon^2\), independent of stage. The stochastic process \(\beta(h)\) is assumed a priori to be a Gaussian process governed by a Matern covariance function with smoothness parameter \(\nu = 2.5\). An efficient posterior simulation is achieved by sampling from the joint posterior density of the hyperparameters of the model, and then sampling from the density of the latent parameters conditional on the hyperparameters.<br /><br />
Bayesian inference is based on the posterior density and summary statistics such as the posterior mean and 95% posterior intervals are based on the posterior density. Analytical formulas for these summary statistics are intractable in most cases and thus they are computed by generating samples from the posterior density using a Markov chain Monte Carlo simulation.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>B. Hrafnkelsson, H. Sigurdarson, S.M. Gardarsson, 2020, Generalization of the power-law rating curve using hydrodynamic theory and Bayesian hierarchical modeling. arXiv
preprint 2010.04769</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='summary.gplm0.html'>summary.gplm0</a></code> for summaries, <code><a href='predict.gplm0.html'>predict.gplm0</a></code> for prediction. It is also useful to look at <code><a href='spread_draws.html'>spread_draws</a></code> and <code><a href='plot.gplm0.html'>plot.gplm0</a></code> to help visualize the full posterior distributions.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>V316_river</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>formula</span> <span class='op'>&lt;-</span> <span class='va'>Q</span><span class='op'>~</span><span class='va'>W</span>
<span class='va'>gplm0.fit</span> <span class='op'>&lt;-</span> <span class='fu'>gplm0</span><span class='op'>(</span><span class='va'>formula</span>,<span class='va'>V316_river</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>gplm0.fit</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>gplm0.fit</span><span class='op'>)</span>
<span class='va'>gplm0.fit_known_c</span> <span class='op'>&lt;-</span> <span class='fu'>gplm0</span><span class='op'>(</span><span class='va'>formula</span>,<span class='va'>V316_river</span>,c_param<span class='op'>=</span><span class='fl'>0.75</span>,h_max<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>gplm0.fit_known_c</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>gplm0.fit_known_c</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://english.hi.is/staff/birgirhr'>Birgir Hrafnkelsson</a>, <a href='https://github.com/sor16'>Solvi Rognvaldsson</a>, Axel Orn Jansson, Rafael Vias.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


