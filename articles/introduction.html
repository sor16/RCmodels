<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction • bdrc</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction">
<meta property="og:description" content="bdrc">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bdrc</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/background.html">Background</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction.html">Introduction to bdrc</a>
    </li>
    <li>
      <a href="../articles/tournament.html">Tournament - Model Comparison</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sor16/bdrc/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="introduction_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction</h1>
                        <h4 class="author">Sölvi Rögnvaldsson, Axel Örn Jansson, Rafael Vias and Birgir Hrafnkelsson</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sor16/bdrc/blob/master/vignettes/introduction.Rmd"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="hidden name"><code>introduction.Rmd</code></div>

    </div>

    
    
<p>A discharge rating curve is a model that describes the relationship between water stage and discharge in a river. The rating curve is estimated from paired observations of stage and discharge and it is used to predict discharge for a given stage. This is the main practical usage of rating curves as stage is substantially easier to directly observe than discharge. Four different discharge rating curve models are implemented in this R package using a Bayesian hierarchical model:</p>
<p><code><a href="../reference/plm0.html">plm0()</a></code> - Power-law model with a constant variance (hence the 0). This is a Bayesian hierarchical implementation of the most commonly used discharge rating curve model in hydrological practice.</p>
<p><code><a href="../reference/plm.html">plm()</a></code> - Power-law model with variance that varies with stage.</p>
<p><code><a href="../reference/gplm0.html">gplm0()</a></code> - Generalized power-law model with a constant variance (hence the 0). The generalized power-law is introduced in Hrafnkelsson et al. (2020).</p>
<p><code><a href="../reference/gplm.html">gplm()</a></code> - Generalized power-law model with variance that varies with stage. The generalized power-law is introduced in Hrafnkelsson et al. (2020).</p>
<p>For further details about the different models, see Hrafnkelsson et al. (2020). The models differ in their complexity and <tt>gplm</tt> is the most flexible and complex model. We will focus on the use of <tt>gplm</tt> throughout this introduction vignette and explore the different ways to fit the <tt>gplm</tt> and visualize its output. However the API of the functions for the other three models are completely identical so this vignette also helps users to run those models.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="co">#load the packages needed for this vignette</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="er">&gt;</span><span class="st"> </span><span class="kw">library</span>(bdrc)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">library</span>(ggplot2)</span></code></pre></div>
<p>We will use a dataset from a stream gauging station called Kallstorp in Sweden that comes with the package:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">data</span>(kallstorp)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="op">&gt;</span><span class="st"> </span>kallstorp</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#&gt;         W        Q</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">#&gt; 1  22.398  0.00260</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">#&gt; 2  22.431  0.01150</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">#&gt; 3  22.483  0.04800</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">#&gt; 4  22.486  0.06710</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#&gt; 5  22.520  0.16400</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">#&gt; 6  22.528  0.12000</span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co">#&gt; 7  22.541  0.18800</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">#&gt; 8  22.554  0.19200</span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">#&gt; 9  22.559  0.17300</span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co">#&gt; 10 22.585  0.36200</span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co">#&gt; 11 22.623  0.40100</span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co">#&gt; 12 22.639  0.59000</span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co">#&gt; 13 22.642  0.70200</span></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co">#&gt; 14 22.642  0.67738</span></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co">#&gt; 15 22.657  0.70357</span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="co">#&gt; 16 22.660  0.70600</span></span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="co">#&gt; 17 22.661  0.70300</span></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="co">#&gt; 18 22.678  0.77400</span></span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="co">#&gt; 19 22.689  0.75900</span></span>
<span id="cb2-23"><a href="#cb2-23"></a><span class="co">#&gt; 20 22.736  1.63800</span></span>
<span id="cb2-24"><a href="#cb2-24"></a><span class="co">#&gt; 21 22.761  1.42800</span></span>
<span id="cb2-25"><a href="#cb2-25"></a><span class="co">#&gt; 22 22.761  1.42000</span></span>
<span id="cb2-26"><a href="#cb2-26"></a><span class="co">#&gt; 23 22.776  1.89700</span></span>
<span id="cb2-27"><a href="#cb2-27"></a><span class="co">#&gt; 24 22.800  1.85200</span></span>
<span id="cb2-28"><a href="#cb2-28"></a><span class="co">#&gt; 25 22.813  2.47160</span></span>
<span id="cb2-29"><a href="#cb2-29"></a><span class="co">#&gt; 26 22.813  1.94800</span></span>
<span id="cb2-30"><a href="#cb2-30"></a><span class="co">#&gt; 27 22.819  2.35200</span></span>
<span id="cb2-31"><a href="#cb2-31"></a><span class="co">#&gt; 28 22.833  2.11000</span></span>
<span id="cb2-32"><a href="#cb2-32"></a><span class="co">#&gt; 29 22.840  2.59850</span></span>
<span id="cb2-33"><a href="#cb2-33"></a><span class="co">#&gt; 30 22.863  2.95200</span></span>
<span id="cb2-34"><a href="#cb2-34"></a><span class="co">#&gt; 31 22.870  2.76600</span></span>
<span id="cb2-35"><a href="#cb2-35"></a><span class="co">#&gt; 32 22.905  3.59000</span></span>
<span id="cb2-36"><a href="#cb2-36"></a><span class="co">#&gt; 33 22.908  3.35000</span></span>
<span id="cb2-37"><a href="#cb2-37"></a><span class="co">#&gt; 34 22.945  4.33325</span></span>
<span id="cb2-38"><a href="#cb2-38"></a><span class="co">#&gt; 35 22.985  4.88000</span></span>
<span id="cb2-39"><a href="#cb2-39"></a><span class="co">#&gt; 36 23.017  5.54200</span></span>
<span id="cb2-40"><a href="#cb2-40"></a><span class="co">#&gt; 37 23.043  6.15100</span></span>
<span id="cb2-41"><a href="#cb2-41"></a><span class="co">#&gt; 38 23.131  7.04000</span></span>
<span id="cb2-42"><a href="#cb2-42"></a><span class="co">#&gt; 39 23.134  7.47900</span></span>
<span id="cb2-43"><a href="#cb2-43"></a><span class="co">#&gt; 40 23.209  8.23800</span></span>
<span id="cb2-44"><a href="#cb2-44"></a><span class="co">#&gt; 41 23.241  9.18400</span></span>
<span id="cb2-45"><a href="#cb2-45"></a><span class="co">#&gt; 42 23.278  9.25100</span></span>
<span id="cb2-46"><a href="#cb2-46"></a><span class="co">#&gt; 43 23.290  9.02000</span></span>
<span id="cb2-47"><a href="#cb2-47"></a><span class="co">#&gt; 44 23.346 10.28600</span></span>
<span id="cb2-48"><a href="#cb2-48"></a><span class="co">#&gt; 45 23.439 10.59400</span></span>
<span id="cb2-49"><a href="#cb2-49"></a><span class="co">#&gt; 46 23.440 11.86000</span></span>
<span id="cb2-50"><a href="#cb2-50"></a><span class="co">#&gt; 47 23.447 11.85000</span></span>
<span id="cb2-51"><a href="#cb2-51"></a><span class="co">#&gt; 48 23.700 15.93000</span></span>
<span id="cb2-52"><a href="#cb2-52"></a><span class="co">#&gt; 49 23.810 18.39400</span></span>
<span id="cb2-53"><a href="#cb2-53"></a><span class="co">#&gt; 50 23.892 22.60000</span></span>
<span id="cb2-54"><a href="#cb2-54"></a><span class="co">#&gt; 51 23.923 22.10000</span></span>
<span id="cb2-55"><a href="#cb2-55"></a><span class="co">#&gt; 52 23.924 21.60000</span></span></code></pre></div>
<div id="fitting-a-discharge-rating-curve" class="section level2">
<h2 class="hasAnchor">
<a href="#fitting-a-discharge-rating-curve" class="anchor"></a>Fitting a discharge rating curve</h2>
<p>It is very simple to fit a discharge rating curve with the <em>bdrc</em> package. All you need are two mandatory input arguments, <tt>formula</tt> and <tt>argument</tt>. The <tt>formula</tt> is of the form <tt>y</tt>~<tt>x</tt> where <tt>y</tt> is discharge in m<span class="math inline">\(^3/\)</span>s and <tt>x</tt> is stage in m (it is very important that the data is in the correct units). The <tt>data</tt> argument must be a data.frame including <tt>x</tt> and <tt>y</tt> as column names. In our case, in kallstorp, a column named Q includes discharge measurements and W the stage measurements. We are ready to fit a discharge rating curve using the <tt>gplm</tt> function:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="op">&gt;</span><span class="st"> </span>gplm.fit &lt;-<span class="st"> </span><span class="kw">gplm</span>(Q<span class="op">~</span>W,<span class="dt">data=</span>kallstorp)</span></code></pre></div>
<p><tt>gplm</tt> returns an object of class “gplm” which we can summarize and visualize using familiar functions such as</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">summary</span>(gplm.fit)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">#&gt; </span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">#&gt; Formula: </span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">#&gt;  Q ~ W</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">#&gt; Latent parameters:</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co">#&gt;   lower-2.5% median-50% upper-97.5%</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co">#&gt; a 9.84       10.42      11.14      </span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">#&gt; b 1.83        1.84       1.84      </span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co">#&gt; </span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co">#&gt; Hyperparameters:</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co">#&gt;            lower-2.5% median-50% upper-97.5%</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co">#&gt; c           22.3397   22.358     22.371     </span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co">#&gt; sigma_beta   0.2739    0.521      1.067     </span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co">#&gt; phi_beta     0.3478    0.739      1.497     </span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="co">#&gt; sigma_eta    0.0307    0.450      0.978     </span></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="co">#&gt; eta_1       -4.7660   -4.093     -3.108     </span></span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="co">#&gt; eta_2       -5.9551   -4.225     -2.906     </span></span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="co">#&gt; eta_3       -7.7969   -5.752     -3.492     </span></span>
<span id="cb4-19"><a href="#cb4-19"></a><span class="co">#&gt; eta_4       -9.2092   -6.834     -3.604     </span></span>
<span id="cb4-20"><a href="#cb4-20"></a><span class="co">#&gt; eta_5      -10.0255   -7.136     -3.391     </span></span>
<span id="cb4-21"><a href="#cb4-21"></a><span class="co">#&gt; eta_6      -10.4760   -7.199     -3.300     </span></span>
<span id="cb4-22"><a href="#cb4-22"></a><span class="co">#&gt; </span></span>
<span id="cb4-23"><a href="#cb4-23"></a><span class="co">#&gt; DIC: -37.48355</span></span></code></pre></div>
<p>and</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(gplm.fit)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-5-1.png" width="768" style="display: block; margin: auto;"></p>
<p>In the next section we will dive deeper into visualizing the “gplm” object.</p>
</div>
<div id="visualizing-posterior-distributions-of-different-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#visualizing-posterior-distributions-of-different-parameters" class="anchor"></a>Visualizing posterior distributions of different parameters</h2>
<p>The <em>bdrc</em> package provides several tools to visualize the results from model objects which can give insight into the physical properties of the river at hand. For instance, the hyperparameter <span class="math inline">\(c\)</span> corresponds to the stage of zero discharge. To visualize the posterior of <span class="math inline">\(c\)</span>, we can write</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(gplm.fit,<span class="dt">type=</span><span class="st">'histogram'</span>,<span class="dt">param=</span><span class="st">'c'</span>)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-6-1.png" width="768" style="display: block; margin: auto;"> Technically, instead of inferring <span class="math inline">\(c\)</span> directly, <span class="math inline">\(h_{min}-c\)</span> is inferred where <span class="math inline">\(h_{min}\)</span> is the lowest stage value in the data. Since <span class="math inline">\(h_{min}-c\)</span> is strictly positive, it is transformed during Bayesian inference s.t. it has support on the real line with <span class="math inline">\(\zeta=log(h_{min}-c)\)</span>. To plot the transformed posterior we write</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(gplm.fit,<span class="dt">type=</span><span class="st">'histogram'</span>,<span class="dt">param=</span><span class="st">'c'</span>,<span class="dt">transformed=</span>T)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-7-1.png" width="768" style="display: block; margin: auto;"> the <tt>param</tt> argument can also be a vector of different parameter names. To visualize the posterior distribution of many parameters at once we can for instance write</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(gplm.fit,<span class="dt">type=</span><span class="st">'histogram'</span>,<span class="dt">param=</span><span class="kw">c</span>(<span class="st">'a'</span>,<span class="st">'c'</span>))</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-8-1.png" width="768" style="display: block; margin: auto;"> There is a shorthand to visualize all hyperparameters at once</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(gplm.fit,<span class="dt">type=</span><span class="st">'histogram'</span>,<span class="dt">param=</span><span class="st">'hyperparameters'</span>)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-9-1.png" width="960" style="display: block; margin: auto;"> Similairily, writing ‘latent_parameters’ plots the latent parameters in one plot. To plot the hyperparameters transformed, on the same scale as in the Bayesian inference, we write</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(gplm.fit,<span class="dt">type=</span><span class="st">'histogram'</span>,<span class="dt">param=</span><span class="st">'hyperparameters'</span>,<span class="dt">transformed=</span>T)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-10-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Finally, we can visualize certain components of the model that varies with stage, the power-law exponent, <span class="math inline">\(f(h)\)</span>, and the standard deviation on the data level <span class="math inline">\(\sigma_{\varepsilon}(h)\)</span>. <tt>gplm0</tt> and <tt>gplm</tt> generalize the power law exponent, model it as a stochastic process,<span class="math inline">\(f(h)=b+\beta(h)\)</span>, which assumed to be twice differentiable.<tt>plm</tt> and <tt>plm0</tt> on the other hand model the exponent as a fixed constant <span class="math inline">\(f(h)=b\)</span>. We can plot the inferred power-law exponent with</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(gplm.fit,<span class="dt">type=</span><span class="st">'f'</span>)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-11-1.png" width="768" style="display: block; margin: auto;"><tt>plm</tt> and <tt>gplm</tt> model the standard deviation, <span class="math inline">\(\sigma_{\varepsilon}\)</span> on the data level as a function of stage, namely using B-splines basis functions, while <tt>plm0</tt> and <tt>gplm0</tt> model the variance is a fixed constant. We can plot the standard deviation by writing</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(gplm.fit,<span class="dt">type=</span><span class="st">'sigma_eps'</span>)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-12-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div id="assessing-model-fitness-and-convergence" class="section level2">
<h2 class="hasAnchor">
<a href="#assessing-model-fitness-and-convergence" class="anchor"></a>Assessing model fitness and convergence</h2>
<p>The package has several functions for convergence diagnostics of a bdrc model, most notably the residual plot, tracing plots, autocorrelation plot and the Gelman-Rubin statistic plot. The log-residuals can be plotted with</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(gplm.fit,<span class="dt">type=</span><span class="st">'residuals'</span>)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-13-1.png" width="768" style="display: block; margin: auto;"> The log-residuals are calculated by subtracting the posterior estimate of log-discharge,<span class="math inline">\(log(\hat{Q})\)</span>, from the observed log-discharge. Additionally, the plot includes the 95% predictive intervals for log(Q) (- -) and 95% credible intervals for the expected value of log(Q) (—), reflecting the rating curve uncertainty.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(gplm.fit,<span class="dt">type=</span><span class="st">'trace'</span>,<span class="dt">param=</span><span class="st">'c'</span>,<span class="dt">transformed=</span>T)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-14-1.png" width="960" style="display: block; margin: auto;"></p>
<p>To plot a trace plot for all hyperparameters, you write similiarily as above</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(gplm.fit,<span class="dt">type=</span><span class="st">'trace'</span>,<span class="dt">param=</span><span class="st">'hyperparameters'</span>,<span class="dt">transformed=</span>T)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-15-1.png" width="960" style="display: block; margin: auto;"></p>
<p>To assess the mixing and convergence of the MCMC chains for each parameter, you can visualize <span class="math inline">\(\hat{R}\)</span> as presented by Gelman and Rubin with:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(gplm.fit,<span class="dt">type=</span><span class="st">'r_hat'</span>)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-16-1.png" width="768" style="display: block; margin: auto;"> And finally autocorrelation of parameters can be assessed with</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(gplm.fit,<span class="dt">type=</span><span class="st">'autocorrelation'</span>)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-17-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div id="customization-of-models" class="section level2">
<h2 class="hasAnchor">
<a href="#customization-of-models" class="anchor"></a>Customization of models</h2>
<p>There are ways to customize the <tt>gplm</tt> further. In some instances, the parameter of zero discharge, <span class="math inline">\(c\)</span>, is known and then you want to fix that parameter to the known value in the model. In addition you might want to extrapolate the rating curve to higher stage values by adjusting the maximum stage. Assume 22.35 m is the known value of <span class="math inline">\(c\)</span> and you want to calculate the rating curve for stage values up to 24 m, then your function call would look like this</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="op">&gt;</span><span class="st"> </span>gplm.fit.known_c &lt;-<span class="st"> </span><span class="kw">gplm</span>(Q<span class="op">~</span>W,kallstorp,<span class="dt">c_param=</span><span class="fl">22.35</span>,<span class="dt">h_max=</span><span class="dv">24</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">summary</span>(gplm.fit.known_c)</span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co">#&gt; </span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="co">#&gt; Formula: </span></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="co">#&gt;  Q ~ W</span></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="co">#&gt; Latent parameters:</span></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="co">#&gt;   lower-2.5% median-50% upper-97.5%</span></span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="co">#&gt; a 9.77       10.34      11.06      </span></span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="co">#&gt; b 1.83        1.84       1.84      </span></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="co">#&gt; </span></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="co">#&gt; Hyperparameters:</span></span>
<span id="cb18-12"><a href="#cb18-12"></a><span class="co">#&gt;            lower-2.5% median-50% upper-97.5%</span></span>
<span id="cb18-13"><a href="#cb18-13"></a><span class="co">#&gt; sigma_beta   0.3273    0.593      1.156     </span></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="co">#&gt; phi_beta     0.3791    0.818      1.643     </span></span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="co">#&gt; sigma_eta    0.0109    0.376      0.957     </span></span>
<span id="cb18-16"><a href="#cb18-16"></a><span class="co">#&gt; eta_1       -4.8360   -4.211     -3.262     </span></span>
<span id="cb18-17"><a href="#cb18-17"></a><span class="co">#&gt; eta_2       -5.9053   -4.226     -2.798     </span></span>
<span id="cb18-18"><a href="#cb18-18"></a><span class="co">#&gt; eta_3       -7.5922   -5.580     -3.090     </span></span>
<span id="cb18-19"><a href="#cb18-19"></a><span class="co">#&gt; eta_4       -9.1550   -6.567     -2.931     </span></span>
<span id="cb18-20"><a href="#cb18-20"></a><span class="co">#&gt; eta_5       -9.9537   -6.863     -2.663     </span></span>
<span id="cb18-21"><a href="#cb18-21"></a><span class="co">#&gt; eta_6      -10.5211   -6.904     -2.305     </span></span>
<span id="cb18-22"><a href="#cb18-22"></a><span class="co">#&gt; </span></span>
<span id="cb18-23"><a href="#cb18-23"></a><span class="co">#&gt; DIC: -36.50393</span></span></code></pre></div>
<p>one neat way to get a visualization summary of your model is to use the ‘panel’ option in the plot method:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(gplm.fit.known_c,<span class="dt">type=</span><span class="st">'panel'</span>,<span class="dt">transformed=</span>T)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-18-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div id="prediction-for-an-equally-spaced-grid-of-stages" class="section level2">
<h2 class="hasAnchor">
<a href="#prediction-for-an-equally-spaced-grid-of-stages" class="anchor"></a>Prediction for an equally spaced grid of stages</h2>
<p>To get rating curve predictions for an equally spaced grid of stage values, you can use the predict function. Note that only values in the range from <span class="math inline">\(c\)</span> and h_max are accepted, as that is the range in which Bayesian inference was performed</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="op">&gt;</span><span class="st"> </span>h_grid &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">22.35</span>,<span class="dv">24</span>,<span class="dt">by=</span><span class="fl">0.01</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="op">&gt;</span><span class="st"> </span>rating_curve_h_grid &lt;-<span class="st"> </span><span class="kw">predict</span>(gplm.fit.known_c,<span class="dt">newdata=</span>h_grid)</span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">print</span>(rating_curve_h_grid)</span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="co">#&gt;         h        lower       median        upper</span></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="co">#&gt; 1   22.35 0.000000e+00 0.000000e+00 0.000000e+00</span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="co">#&gt; 2   22.36 4.087878e-04 5.620219e-04 7.934194e-04</span></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="co">#&gt; 3   22.37 8.175756e-04 1.124044e-03 1.586839e-03</span></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="co">#&gt; 4   22.38 1.226363e-03 1.686066e-03 2.380258e-03</span></span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="co">#&gt; 5   22.39 1.635151e-03 2.248088e-03 3.173677e-03</span></span>
<span id="cb20-10"><a href="#cb20-10"></a><span class="co">#&gt; 6   22.40 2.418998e-03 3.296221e-03 4.596070e-03</span></span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="co">#&gt; 7   22.41 4.703082e-03 6.288801e-03 8.534357e-03</span></span>
<span id="cb20-12"><a href="#cb20-12"></a><span class="co">#&gt; 8   22.42 6.987165e-03 9.281381e-03 1.247264e-02</span></span>
<span id="cb20-13"><a href="#cb20-13"></a><span class="co">#&gt; 9   22.43 9.271248e-03 1.227396e-02 1.641093e-02</span></span>
<span id="cb20-14"><a href="#cb20-14"></a><span class="co">#&gt; 10  22.44 1.347585e-02 1.766139e-02 2.336072e-02</span></span>
<span id="cb20-15"><a href="#cb20-15"></a><span class="co">#&gt; 11  22.45 1.820010e-02 2.372407e-02 3.119771e-02</span></span>
<span id="cb20-16"><a href="#cb20-16"></a><span class="co">#&gt; 12  22.46 2.445565e-02 3.183250e-02 4.179766e-02</span></span>
<span id="cb20-17"><a href="#cb20-17"></a><span class="co">#&gt; 13  22.47 3.167829e-02 4.122387e-02 5.375135e-02</span></span>
<span id="cb20-18"><a href="#cb20-18"></a><span class="co">#&gt; 14  22.48 4.016559e-02 5.229293e-02 6.747531e-02</span></span>
<span id="cb20-19"><a href="#cb20-19"></a><span class="co">#&gt; 15  22.49 5.086756e-02 6.631130e-02 8.642389e-02</span></span>
<span id="cb20-20"><a href="#cb20-20"></a><span class="co">#&gt; 16  22.50 6.429450e-02 8.331187e-02 1.081725e-01</span></span>
<span id="cb20-21"><a href="#cb20-21"></a><span class="co">#&gt; 17  22.51 7.772145e-02 1.003124e-01 1.299212e-01</span></span>
<span id="cb20-22"><a href="#cb20-22"></a><span class="co">#&gt; 18  22.52 9.114839e-02 1.173130e-01 1.516698e-01</span></span>
<span id="cb20-23"><a href="#cb20-23"></a><span class="co">#&gt; 19  22.53 1.086318e-01 1.395501e-01 1.810180e-01</span></span>
<span id="cb20-24"><a href="#cb20-24"></a><span class="co">#&gt; 20  22.54 1.272687e-01 1.638320e-01 2.118273e-01</span></span>
<span id="cb20-25"><a href="#cb20-25"></a><span class="co">#&gt; 21  22.55 1.492428e-01 1.920888e-01 2.465353e-01</span></span>
<span id="cb20-26"><a href="#cb20-26"></a><span class="co">#&gt; 22  22.56 1.726130e-01 2.222596e-01 2.831986e-01</span></span>
<span id="cb20-27"><a href="#cb20-27"></a><span class="co">#&gt; 23  22.57 2.011162e-01 2.575920e-01 3.286426e-01</span></span>
<span id="cb20-28"><a href="#cb20-28"></a><span class="co">#&gt; 24  22.58 2.296193e-01 2.929244e-01 3.740865e-01</span></span>
<span id="cb20-29"><a href="#cb20-29"></a><span class="co">#&gt; 25  22.59 2.623502e-01 3.337144e-01 4.257788e-01</span></span>
<span id="cb20-30"><a href="#cb20-30"></a><span class="co">#&gt; 26  22.60 2.993088e-01 3.799619e-01 4.837194e-01</span></span>
<span id="cb20-31"><a href="#cb20-31"></a><span class="co">#&gt; 27  22.61 3.362674e-01 4.262095e-01 5.416601e-01</span></span>
<span id="cb20-32"><a href="#cb20-32"></a><span class="co">#&gt; 28  22.62 3.732261e-01 4.724570e-01 5.996007e-01</span></span>
<span id="cb20-33"><a href="#cb20-33"></a><span class="co">#&gt; 29  22.63 4.136741e-01 5.248678e-01 6.655890e-01</span></span>
<span id="cb20-34"><a href="#cb20-34"></a><span class="co">#&gt; 30  22.64 4.571044e-01 5.805902e-01 7.352810e-01</span></span>
<span id="cb20-35"><a href="#cb20-35"></a><span class="co">#&gt; 31  22.65 5.096484e-01 6.416544e-01 8.080954e-01</span></span>
<span id="cb20-36"><a href="#cb20-36"></a><span class="co">#&gt; 32  22.66 5.571589e-01 7.054068e-01 8.901386e-01</span></span>
<span id="cb20-37"><a href="#cb20-37"></a><span class="co">#&gt; 33  22.67 6.147191e-01 7.752908e-01 9.759503e-01</span></span>
<span id="cb20-38"><a href="#cb20-38"></a><span class="co">#&gt; 34  22.68 6.726476e-01 8.459464e-01 1.063447e+00</span></span>
<span id="cb20-39"><a href="#cb20-39"></a><span class="co">#&gt; 35  22.69 7.359471e-01 9.232040e-01 1.155433e+00</span></span>
<span id="cb20-40"><a href="#cb20-40"></a><span class="co">#&gt; 36  22.70 8.065959e-01 1.009899e+00 1.261203e+00</span></span>
<span id="cb20-41"><a href="#cb20-41"></a><span class="co">#&gt; 37  22.71 8.772448e-01 1.096594e+00 1.366974e+00</span></span>
<span id="cb20-42"><a href="#cb20-42"></a><span class="co">#&gt; 38  22.72 9.478936e-01 1.183289e+00 1.472744e+00</span></span>
<span id="cb20-43"><a href="#cb20-43"></a><span class="co">#&gt; 39  22.73 1.018542e+00 1.269984e+00 1.578514e+00</span></span>
<span id="cb20-44"><a href="#cb20-44"></a><span class="co">#&gt; 40  22.74 1.093527e+00 1.362128e+00 1.690963e+00</span></span>
<span id="cb20-45"><a href="#cb20-45"></a><span class="co">#&gt; 41  22.75 1.175015e+00 1.462446e+00 1.813428e+00</span></span>
<span id="cb20-46"><a href="#cb20-46"></a><span class="co">#&gt; 42  22.76 1.256503e+00 1.562764e+00 1.935893e+00</span></span>
<span id="cb20-47"><a href="#cb20-47"></a><span class="co">#&gt; 43  22.77 1.344062e+00 1.671075e+00 2.070492e+00</span></span>
<span id="cb20-48"><a href="#cb20-48"></a><span class="co">#&gt; 44  22.78 1.436748e+00 1.782687e+00 2.210352e+00</span></span>
<span id="cb20-49"><a href="#cb20-49"></a><span class="co">#&gt; 45  22.79 1.536114e+00 1.897922e+00 2.356081e+00</span></span>
<span id="cb20-50"><a href="#cb20-50"></a><span class="co">#&gt; 46  22.80 1.635480e+00 2.013156e+00 2.501810e+00</span></span>
<span id="cb20-51"><a href="#cb20-51"></a><span class="co">#&gt; 47  22.81 1.737653e+00 2.136914e+00 2.622214e+00</span></span>
<span id="cb20-52"><a href="#cb20-52"></a><span class="co">#&gt; 48  22.82 1.835753e+00 2.262668e+00 2.790970e+00</span></span>
<span id="cb20-53"><a href="#cb20-53"></a><span class="co">#&gt; 49  22.83 1.951449e+00 2.397590e+00 2.933304e+00</span></span>
<span id="cb20-54"><a href="#cb20-54"></a><span class="co">#&gt; 50  22.84 2.056326e+00 2.526397e+00 3.086042e+00</span></span>
<span id="cb20-55"><a href="#cb20-55"></a><span class="co">#&gt; 51  22.85 2.172307e+00 2.668337e+00 3.261536e+00</span></span>
<span id="cb20-56"><a href="#cb20-56"></a><span class="co">#&gt; 52  22.86 2.288287e+00 2.810277e+00 3.437029e+00</span></span>
<span id="cb20-57"><a href="#cb20-57"></a><span class="co">#&gt; 53  22.87 2.408310e+00 2.943921e+00 3.608662e+00</span></span>
<span id="cb20-58"><a href="#cb20-58"></a><span class="co">#&gt; 54  22.88 2.527698e+00 3.095877e+00 3.786866e+00</span></span>
<span id="cb20-59"><a href="#cb20-59"></a><span class="co">#&gt; 55  22.89 2.647086e+00 3.247834e+00 3.965070e+00</span></span>
<span id="cb20-60"><a href="#cb20-60"></a><span class="co">#&gt; 56  22.90 2.766474e+00 3.399790e+00 4.143274e+00</span></span>
<span id="cb20-61"><a href="#cb20-61"></a><span class="co">#&gt; 57  22.91 2.908401e+00 3.551205e+00 4.356945e+00</span></span>
<span id="cb20-62"><a href="#cb20-62"></a><span class="co">#&gt; 58  22.92 3.033742e+00 3.712887e+00 4.539998e+00</span></span>
<span id="cb20-63"><a href="#cb20-63"></a><span class="co">#&gt; 59  22.93 3.159083e+00 3.874570e+00 4.723051e+00</span></span>
<span id="cb20-64"><a href="#cb20-64"></a><span class="co">#&gt; 60  22.94 3.284425e+00 4.036252e+00 4.906104e+00</span></span>
<span id="cb20-65"><a href="#cb20-65"></a><span class="co">#&gt; 61  22.95 3.416267e+00 4.198315e+00 5.095579e+00</span></span>
<span id="cb20-66"><a href="#cb20-66"></a><span class="co">#&gt; 62  22.96 3.554612e+00 4.360759e+00 5.291478e+00</span></span>
<span id="cb20-67"><a href="#cb20-67"></a><span class="co">#&gt; 63  22.97 3.692956e+00 4.523202e+00 5.487376e+00</span></span>
<span id="cb20-68"><a href="#cb20-68"></a><span class="co">#&gt; 64  22.98 3.831300e+00 4.685646e+00 5.683274e+00</span></span>
<span id="cb20-69"><a href="#cb20-69"></a><span class="co">#&gt; 65  22.99 3.967717e+00 4.847594e+00 5.882681e+00</span></span>
<span id="cb20-70"><a href="#cb20-70"></a><span class="co">#&gt; 66  23.00 4.102207e+00 5.009046e+00 6.085598e+00</span></span>
<span id="cb20-71"><a href="#cb20-71"></a><span class="co">#&gt; 67  23.01 4.236697e+00 5.170499e+00 6.288514e+00</span></span>
<span id="cb20-72"><a href="#cb20-72"></a><span class="co">#&gt; 68  23.02 4.374969e+00 5.334816e+00 6.481807e+00</span></span>
<span id="cb20-73"><a href="#cb20-73"></a><span class="co">#&gt; 69  23.03 4.522067e+00 5.505815e+00 6.652647e+00</span></span>
<span id="cb20-74"><a href="#cb20-74"></a><span class="co">#&gt; 70  23.04 4.669166e+00 5.676814e+00 6.823487e+00</span></span>
<span id="cb20-75"><a href="#cb20-75"></a><span class="co">#&gt; 71  23.05 4.805698e+00 5.843465e+00 7.012909e+00</span></span>
<span id="cb20-76"><a href="#cb20-76"></a><span class="co">#&gt; 72  23.06 4.937703e+00 6.008251e+00 7.210296e+00</span></span>
<span id="cb20-77"><a href="#cb20-77"></a><span class="co">#&gt; 73  23.07 5.069708e+00 6.173038e+00 7.407682e+00</span></span>
<span id="cb20-78"><a href="#cb20-78"></a><span class="co">#&gt; 74  23.08 5.208916e+00 6.335709e+00 7.602326e+00</span></span>
<span id="cb20-79"><a href="#cb20-79"></a><span class="co">#&gt; 75  23.09 5.350316e+00 6.497738e+00 7.796134e+00</span></span>
<span id="cb20-80"><a href="#cb20-80"></a><span class="co">#&gt; 76  23.10 5.491717e+00 6.659766e+00 7.989943e+00</span></span>
<span id="cb20-81"><a href="#cb20-81"></a><span class="co">#&gt; 77  23.11 5.618163e+00 6.817048e+00 8.179979e+00</span></span>
<span id="cb20-82"><a href="#cb20-82"></a><span class="co">#&gt; 78  23.12 5.741619e+00 6.973382e+00 8.369259e+00</span></span>
<span id="cb20-83"><a href="#cb20-83"></a><span class="co">#&gt; 79  23.13 5.865075e+00 7.129716e+00 8.558540e+00</span></span>
<span id="cb20-84"><a href="#cb20-84"></a><span class="co">#&gt; 80  23.14 6.005870e+00 7.290892e+00 8.770581e+00</span></span>
<span id="cb20-85"><a href="#cb20-85"></a><span class="co">#&gt; 81  23.15 6.144424e+00 7.445112e+00 8.964695e+00</span></span>
<span id="cb20-86"><a href="#cb20-86"></a><span class="co">#&gt; 82  23.16 6.282065e+00 7.598531e+00 9.155703e+00</span></span>
<span id="cb20-87"><a href="#cb20-87"></a><span class="co">#&gt; 83  23.17 6.411484e+00 7.744751e+00 9.318748e+00</span></span>
<span id="cb20-88"><a href="#cb20-88"></a><span class="co">#&gt; 84  23.18 6.540903e+00 7.890970e+00 9.481794e+00</span></span>
<span id="cb20-89"><a href="#cb20-89"></a><span class="co">#&gt; 85  23.19 6.676477e+00 8.040923e+00 9.660618e+00</span></span>
<span id="cb20-90"><a href="#cb20-90"></a><span class="co">#&gt; 86  23.20 6.816154e+00 8.193364e+00 9.849960e+00</span></span>
<span id="cb20-91"><a href="#cb20-91"></a><span class="co">#&gt; 87  23.21 6.954793e+00 8.344786e+00 1.003770e+01</span></span>
<span id="cb20-92"><a href="#cb20-92"></a><span class="co">#&gt; 88  23.22 7.084085e+00 8.487045e+00 1.021104e+01</span></span>
<span id="cb20-93"><a href="#cb20-93"></a><span class="co">#&gt; 89  23.23 7.213377e+00 8.629304e+00 1.038437e+01</span></span>
<span id="cb20-94"><a href="#cb20-94"></a><span class="co">#&gt; 90  23.24 7.342670e+00 8.771564e+00 1.055771e+01</span></span>
<span id="cb20-95"><a href="#cb20-95"></a><span class="co">#&gt; 91  23.25 7.459110e+00 8.915044e+00 1.073595e+01</span></span>
<span id="cb20-96"><a href="#cb20-96"></a><span class="co">#&gt; 92  23.26 7.574121e+00 9.058660e+00 1.091473e+01</span></span>
<span id="cb20-97"><a href="#cb20-97"></a><span class="co">#&gt; 93  23.27 7.689133e+00 9.202276e+00 1.109352e+01</span></span>
<span id="cb20-98"><a href="#cb20-98"></a><span class="co">#&gt; 94  23.28 7.813937e+00 9.346320e+00 1.126237e+01</span></span>
<span id="cb20-99"><a href="#cb20-99"></a><span class="co">#&gt; 95  23.29 7.977911e+00 9.492076e+00 1.139148e+01</span></span>
<span id="cb20-100"><a href="#cb20-100"></a><span class="co">#&gt; 96  23.30 8.066738e+00 9.627565e+00 1.156767e+01</span></span>
<span id="cb20-101"><a href="#cb20-101"></a><span class="co">#&gt; 97  23.31 8.162521e+00 9.763877e+00 1.174831e+01</span></span>
<span id="cb20-102"><a href="#cb20-102"></a><span class="co">#&gt; 98  23.32 8.303513e+00 9.905542e+00 1.195795e+01</span></span>
<span id="cb20-103"><a href="#cb20-103"></a><span class="co">#&gt; 99  23.33 8.435730e+00 1.004906e+01 1.215573e+01</span></span>
<span id="cb20-104"><a href="#cb20-104"></a><span class="co">#&gt; 100 23.34 8.543812e+00 1.019769e+01 1.232090e+01</span></span>
<span id="cb20-105"><a href="#cb20-105"></a><span class="co">#&gt; 101 23.35 8.656277e+00 1.034168e+01 1.249128e+01</span></span>
<span id="cb20-106"><a href="#cb20-106"></a><span class="co">#&gt; 102 23.36 8.775316e+00 1.047873e+01 1.266947e+01</span></span>
<span id="cb20-107"><a href="#cb20-107"></a><span class="co">#&gt; 103 23.37 8.894355e+00 1.061577e+01 1.284767e+01</span></span>
<span id="cb20-108"><a href="#cb20-108"></a><span class="co">#&gt; 104 23.38 9.016226e+00 1.075454e+01 1.302899e+01</span></span>
<span id="cb20-109"><a href="#cb20-109"></a><span class="co">#&gt; 105 23.39 9.144704e+00 1.089734e+01 1.321760e+01</span></span>
<span id="cb20-110"><a href="#cb20-110"></a><span class="co">#&gt; 106 23.40 9.273183e+00 1.104015e+01 1.340621e+01</span></span>
<span id="cb20-111"><a href="#cb20-111"></a><span class="co">#&gt; 107 23.41 9.398932e+00 1.118448e+01 1.359107e+01</span></span>
<span id="cb20-112"><a href="#cb20-112"></a><span class="co">#&gt; 108 23.42 9.513766e+00 1.133497e+01 1.376095e+01</span></span>
<span id="cb20-113"><a href="#cb20-113"></a><span class="co">#&gt; 109 23.43 9.628600e+00 1.148546e+01 1.393084e+01</span></span>
<span id="cb20-114"><a href="#cb20-114"></a><span class="co">#&gt; 110 23.44 9.779043e+00 1.161160e+01 1.410998e+01</span></span>
<span id="cb20-115"><a href="#cb20-115"></a><span class="co">#&gt; 111 23.45 9.894244e+00 1.176669e+01 1.434280e+01</span></span>
<span id="cb20-116"><a href="#cb20-116"></a><span class="co">#&gt; 112 23.46 1.002281e+01 1.191505e+01 1.452525e+01</span></span>
<span id="cb20-117"><a href="#cb20-117"></a><span class="co">#&gt; 113 23.47 1.015137e+01 1.206341e+01 1.470771e+01</span></span>
<span id="cb20-118"><a href="#cb20-118"></a><span class="co">#&gt; 114 23.48 1.027994e+01 1.221177e+01 1.489016e+01</span></span>
<span id="cb20-119"><a href="#cb20-119"></a><span class="co">#&gt; 115 23.49 1.040791e+01 1.236877e+01 1.507620e+01</span></span>
<span id="cb20-120"><a href="#cb20-120"></a><span class="co">#&gt; 116 23.50 1.053561e+01 1.252973e+01 1.526387e+01</span></span>
<span id="cb20-121"><a href="#cb20-121"></a><span class="co">#&gt; 117 23.51 1.066331e+01 1.269070e+01 1.545154e+01</span></span>
<span id="cb20-122"><a href="#cb20-122"></a><span class="co">#&gt; 118 23.52 1.079245e+01 1.285168e+01 1.564140e+01</span></span>
<span id="cb20-123"><a href="#cb20-123"></a><span class="co">#&gt; 119 23.53 1.094038e+01 1.301288e+01 1.585958e+01</span></span>
<span id="cb20-124"><a href="#cb20-124"></a><span class="co">#&gt; 120 23.54 1.108831e+01 1.317409e+01 1.607776e+01</span></span>
<span id="cb20-125"><a href="#cb20-125"></a><span class="co">#&gt; 121 23.55 1.123623e+01 1.333530e+01 1.629594e+01</span></span>
<span id="cb20-126"><a href="#cb20-126"></a><span class="co">#&gt; 122 23.56 1.138211e+01 1.350413e+01 1.651693e+01</span></span>
<span id="cb20-127"><a href="#cb20-127"></a><span class="co">#&gt; 123 23.57 1.152556e+01 1.368202e+01 1.674124e+01</span></span>
<span id="cb20-128"><a href="#cb20-128"></a><span class="co">#&gt; 124 23.58 1.166901e+01 1.385990e+01 1.696556e+01</span></span>
<span id="cb20-129"><a href="#cb20-129"></a><span class="co">#&gt; 125 23.59 1.181246e+01 1.403779e+01 1.718987e+01</span></span>
<span id="cb20-130"><a href="#cb20-130"></a><span class="co">#&gt; 126 23.60 1.195930e+01 1.421995e+01 1.743233e+01</span></span>
<span id="cb20-131"><a href="#cb20-131"></a><span class="co">#&gt; 127 23.61 1.210677e+01 1.440292e+01 1.767819e+01</span></span>
<span id="cb20-132"><a href="#cb20-132"></a><span class="co">#&gt; 128 23.62 1.225424e+01 1.458588e+01 1.792404e+01</span></span>
<span id="cb20-133"><a href="#cb20-133"></a><span class="co">#&gt; 129 23.63 1.240525e+01 1.477163e+01 1.815947e+01</span></span>
<span id="cb20-134"><a href="#cb20-134"></a><span class="co">#&gt; 130 23.64 1.256820e+01 1.496681e+01 1.835974e+01</span></span>
<span id="cb20-135"><a href="#cb20-135"></a><span class="co">#&gt; 131 23.65 1.273116e+01 1.516199e+01 1.856001e+01</span></span>
<span id="cb20-136"><a href="#cb20-136"></a><span class="co">#&gt; 132 23.66 1.289411e+01 1.535717e+01 1.876027e+01</span></span>
<span id="cb20-137"><a href="#cb20-137"></a><span class="co">#&gt; 133 23.67 1.305123e+01 1.555856e+01 1.897342e+01</span></span>
<span id="cb20-138"><a href="#cb20-138"></a><span class="co">#&gt; 134 23.68 1.320469e+01 1.576384e+01 1.919466e+01</span></span>
<span id="cb20-139"><a href="#cb20-139"></a><span class="co">#&gt; 135 23.69 1.335816e+01 1.596912e+01 1.941590e+01</span></span>
<span id="cb20-140"><a href="#cb20-140"></a><span class="co">#&gt; 136 23.70 1.351162e+01 1.617440e+01 1.963714e+01</span></span>
<span id="cb20-141"><a href="#cb20-141"></a><span class="co">#&gt; 137 23.71 1.371364e+01 1.640585e+01 1.990534e+01</span></span>
<span id="cb20-142"><a href="#cb20-142"></a><span class="co">#&gt; 138 23.72 1.391566e+01 1.663730e+01 2.017354e+01</span></span>
<span id="cb20-143"><a href="#cb20-143"></a><span class="co">#&gt; 139 23.73 1.412162e+01 1.686961e+01 2.043874e+01</span></span>
<span id="cb20-144"><a href="#cb20-144"></a><span class="co">#&gt; 140 23.74 1.433939e+01 1.710448e+01 2.069497e+01</span></span>
<span id="cb20-145"><a href="#cb20-145"></a><span class="co">#&gt; 141 23.75 1.455716e+01 1.733936e+01 2.095120e+01</span></span>
<span id="cb20-146"><a href="#cb20-146"></a><span class="co">#&gt; 142 23.76 1.476515e+01 1.758292e+01 2.121627e+01</span></span>
<span id="cb20-147"><a href="#cb20-147"></a><span class="co">#&gt; 143 23.77 1.496336e+01 1.783517e+01 2.149018e+01</span></span>
<span id="cb20-148"><a href="#cb20-148"></a><span class="co">#&gt; 144 23.78 1.516157e+01 1.808741e+01 2.176409e+01</span></span>
<span id="cb20-149"><a href="#cb20-149"></a><span class="co">#&gt; 145 23.79 1.535235e+01 1.833542e+01 2.208667e+01</span></span>
<span id="cb20-150"><a href="#cb20-150"></a><span class="co">#&gt; 146 23.80 1.554065e+01 1.858202e+01 2.242548e+01</span></span>
<span id="cb20-151"><a href="#cb20-151"></a><span class="co">#&gt; 147 23.81 1.572896e+01 1.882862e+01 2.276429e+01</span></span>
<span id="cb20-152"><a href="#cb20-152"></a><span class="co">#&gt; 148 23.82 1.595977e+01 1.910510e+01 2.303958e+01</span></span>
<span id="cb20-153"><a href="#cb20-153"></a><span class="co">#&gt; 149 23.83 1.619058e+01 1.938159e+01 2.331488e+01</span></span>
<span id="cb20-154"><a href="#cb20-154"></a><span class="co">#&gt; 150 23.84 1.641076e+01 1.965920e+01 2.359403e+01</span></span>
<span id="cb20-155"><a href="#cb20-155"></a><span class="co">#&gt; 151 23.85 1.660169e+01 1.993990e+01 2.388380e+01</span></span>
<span id="cb20-156"><a href="#cb20-156"></a><span class="co">#&gt; 152 23.86 1.679262e+01 2.022060e+01 2.417358e+01</span></span>
<span id="cb20-157"><a href="#cb20-157"></a><span class="co">#&gt; 153 23.87 1.701412e+01 2.050847e+01 2.449383e+01</span></span>
<span id="cb20-158"><a href="#cb20-158"></a><span class="co">#&gt; 154 23.88 1.726236e+01 2.080262e+01 2.484075e+01</span></span>
<span id="cb20-159"><a href="#cb20-159"></a><span class="co">#&gt; 155 23.89 1.751060e+01 2.109677e+01 2.518767e+01</span></span>
<span id="cb20-160"><a href="#cb20-160"></a><span class="co">#&gt; 156 23.90 1.769537e+01 2.139635e+01 2.554273e+01</span></span>
<span id="cb20-161"><a href="#cb20-161"></a><span class="co">#&gt; 157 23.91 1.786427e+01 2.169729e+01 2.589981e+01</span></span>
<span id="cb20-162"><a href="#cb20-162"></a><span class="co">#&gt; 158 23.92 1.803318e+01 2.199823e+01 2.625690e+01</span></span>
<span id="cb20-163"><a href="#cb20-163"></a><span class="co">#&gt; 159 23.93 1.818665e+01 2.230354e+01 2.685107e+01</span></span>
<span id="cb20-164"><a href="#cb20-164"></a><span class="co">#&gt; 160 23.94 1.839570e+01 2.261509e+01 2.727835e+01</span></span>
<span id="cb20-165"><a href="#cb20-165"></a><span class="co">#&gt; 161 23.95 1.860538e+01 2.292558e+01 2.770636e+01</span></span>
<span id="cb20-166"><a href="#cb20-166"></a><span class="co">#&gt; 162 23.96 1.882394e+01 2.322137e+01 2.814454e+01</span></span>
<span id="cb20-167"><a href="#cb20-167"></a><span class="co">#&gt; 163 23.97 1.904250e+01 2.351716e+01 2.858272e+01</span></span>
<span id="cb20-168"><a href="#cb20-168"></a><span class="co">#&gt; 164 23.98 1.922440e+01 2.383891e+01 2.905691e+01</span></span>
<span id="cb20-169"><a href="#cb20-169"></a><span class="co">#&gt; 165 23.99 1.937422e+01 2.418338e+01 2.956261e+01</span></span>
<span id="cb20-170"><a href="#cb20-170"></a><span class="co">#&gt; 166 24.00 1.952403e+01 2.452785e+01 3.006832e+01</span></span></code></pre></div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Hrafnkelsson, B., Sigurdarson, H., and Gardarsson, S. M. (2020). Generalization of the power-law rating curve using hydrodynamic theory and Bayesian hierarchical modeling. arXiv preprint 2010.04769.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://english.hi.is/staff/birgirhr">Birgir Hrafnkelsson</a>, <a href="https://github.com/sor16">Solvi Rognvaldsson</a>, <a href="https://github.com/axelornj">Axel Orn Jansson</a>, <a href="https://github.com/RafaelVias">Rafael Vias</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
